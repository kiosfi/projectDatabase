<section data-ng-controller="OrganisationsController" data-ng-init="findOne()">
    <style>
        td {padding-left: 3em;}
    </style>


    <!-- TODO: Replace tables with divs like in project view, because divs are
    more flexible. -->



    <div>
        <div id="header">
            <h2><span class="name">{{organisation.name}}</span>
                <span>
                    <!--                Confirm action here-->

                    <a class="btn-lg" id="delete" data-ng-click="confirm(organisation);">
                        <i class="glyphicon glyphicon-trash"></i>
                    </a>
                    <a ng-href="/organisations/{{organisation._id}}/edit" class="btn-lg" id="edit">
                        <span class="glyphicon glyphicon-edit"></span>
                    </a>
                </span>
            </h2>
            <h3>Edustaja: {{organisation.representative.name}}</h3>
            <span><a ng-click="orgEditLog = !orgEditLog" ng-show="organisation.updated.length > 0">Tietoja muokattu</a>
                <ul ng-show="orgEditLog">
                    <li data-ng-repeat="update in organisation.updated">
                        {{update.time| date: 'dd-MM-yyyy HH:mm'}}, muokkaaja: {{update.user}}
                    </li>
                </ul></span>
        </div>
        <div>
            <ul id="menu" class="col-md-3 nav nav-list" style="position: fixed">
                <li>
                    <label><a href="#header">Järjestö</a></label>
                    <ul>
                        <li><a href="#summary">Perustiedot</a></li>
                        <li><a href="#legalStatus">Hallintomalli ja henkilöstö</a></li>
                        <li><a href="#description">Kuvaus</a></li>
                        <li><a href="#connections">Yhteydet</a></li>
                        <li><a href="#bankInfo">Tilitiedot</a></li>
                        <li><a href="#prevApp">Aiemmat hakemukset</a></li>
                        <li><a href="#otherDonors">Järjestön taloustilanne</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <div style="margin-left: 192px">
            <article id="summary" class="org-article">
                <h4>Perustiedot</h4>
                <table class="org-content">
                    <tr>
                        <th>Edustaja</th>
                        <td>{{organisation.representative.name}}<br>
                            {{organisation.representative.email}}<br>
                            {{organisation.representative.phone}}
                        </td>
                    </tr>
                    <tr>
                        <th>Vastuullinen johtaja</th>
                        <td>{{organisation.exec_manager}}</td>
                    </tr>
                    <tr>
                        <th>Viestintävastaava</th>
                        <td>{{organisation.communications_rep}}</td>
                    </tr>
                    <tr>
                        <th>Osoite</th>
                        <td>{{organisation.address.street}}
                            {{organisation.address.postal_code}} {{organisation.address.city}}
                            {{organisation.address.country}}</td>
                    </tr>
                    <tr>
                        <th>Puhelinnumero</th>
                        <td>{{organisation.tel}}</td></tr>
                    <tr>
                        <th>Sähköposti</th>
                        <td>{{organisation.email}}</td>
                    </tr>
                    <tr>
                        <th>Websivut</th>
                        <td>{{organisation.website}}</td>
                    </tr>
                </table>
            </article>
            <article id="bankInfo" class="org-article">
                <h4>Tilitiedot</h4>
                <table class="org-content">
                    <tr>
                        <th>Tilin haltija</th>
                        <td>{{organisation.bank_account.holder_name}}</td>
                    </tr>
                    <tr>
                        <th>Tilinumero (IBAN)</th>
                        <td>{{organisation.bank_account.iban}}</td>
                    </tr>
                    <tr>
                        <th>SWIFT</th>
                        <td>{{organisation.bank_account.swift}}</td>
                    </tr>
                    <tr>
                        <th>Pankin yhteystiedot</th>
                        <td>{{organisation.bank_account.bank_contact_details}}</td>
                    </tr>
                </table>
            </article>
            <article id="prevApp" class="org-article" data-ng-init="findOrgProjects()">
                <h4>KIOS:lta rahoitusta hakeneet hankkeet</h4>
                <div class="org-content">
                    <table>
                        <tr data-ng-repeat="project in orgProjects">
                            <th>
                                <a data-ng-href="/projects/{{project._id}}">
                                    {{project.title}}
                                </a>
                            </th>
                            <td>{{project.approved.granted_sum_eur ?
                                project.approved.granted_sum_eur +" EUR" : "-"}}</td>
                        </tr>
                    </table>
                    <div data-ng-if="!orgProjects.length">Ei rahoitusta hakeneita hankkeita</div>

                </div>
            </article>
            <article id="legalStatus" class="org-article">
                <h4>Hallintomalli ja henkilöstö</h4>
                <section class="org-content">
                    <p>{{organisation.legal_status}}</p>
                </section>
            </article>
            <article id="description" class="org-article">
                <h4>Kuvaus</h4>
                <section class="org-content">
                    <p>{{organisation.description}}</p>
                </section>
            </article>
            <article id="connections" class="org-article">
                <h4>Kansalliset ja kansainväliset yhteydet</h4>
                <section class="org-content">
                    <p>{{organisation.int_links}}</p>
                    <p>{{organisation.nat_local_links}}</p>
                </section>
            </article>
            <article id="otherDonors" class="org-article">
                <h4>Muut rahoittajat ja budjetti</h4>
                <section class="org-content">
                    <p>{{organisation.other_funding_budget}}</p>
                </section>
                <h4>Taloushallinto ja tilintarkastus</h4>
                <section class="org-content">
                    <p>{{organisation.accounting_audit}}</p>
                </section>
            </article>
        </div>
    </div>
</section>
