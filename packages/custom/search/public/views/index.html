<h1>Haku</h1>
<br>
<section data-ng-controller="SearchController">

    <h4>Valitse hakuparametrien määrä listalta:</h4>
    <form name="searchForm" class="form-horizontal" role="form" novalidate>
        <select class="dropdown col-md-3" ng-model="paramNo">
            <option value="2">Kaksi parametria</option>
            <option value="3">Kolme paramentria</option>
        </select>
    </form>
    <div style="clear:both;">&nbsp;</div>

    <article ng-show="paramNo === '2'">
        <form name="searchForm" class="form-horizontal" role="form" data-ng-submit="twoParams()" novalidate>
            <label for="par1">Hakuehto 1</label>
            <div id="par1">
              <select id="field1" class="dropdown col-md-4" ng-model="field1">
                <option ng-repeat="field in fields" value={{field.name}}>{{field.fi}}</option>
              </select>
                <div style="clear:both;">&nbsp;</div>
                <select class="dropdown col-md-4" ng-model="param1" ng-show="field1 === 'state'">
                    <option ng-repeat="state in states" value={{state}}>
                        {{state}}
                    </option>
                </select>
                <div class="col-md-10" ng-show="field1 == 'region'">
                    <input type="text" ng-model="param1" class="form-control" placeholder="Hakusanat">
                </div>
            </div>
            <div style="clear:both;">&nbsp;</div>
            <label for="par2">Hakuehto 2</label>
            <div id="par2">
                <select id="field2" class="dropdown col-md-4" ng-model="field2">
                  <option ng-repeat="field in fields" value={{field.name}}>{{field.fi}}</option>
                </select>
                <div style="clear:both;">&nbsp;</div>
                <select class="dropdown col-md-4" ng-model="param2" ng-show="field2 === 'state'">
                    <option ng-repeat="state in states" value={{state}}>
                        {{state}}
                    </option>
                </select>
                <div class="col-md-10" ng-show="field2 === 'region'">
                    <input type="text" ng-model="param2" class="form-control" placeholder="Hakusanat">
                </div>
            </div>
            <div>
                <button mean-token="'search-submit'"type="submit" class="btn-sm">Hae</button>
            </div>
        </form>
    </article>

    <article class="search">
        <style type="text/css">
            .sortorder:after {
                content: '\25b2';
            }
            .sortorder.reverse:after {
                content: '\25bc';
            }
        </style>
        <h4>Hakutulokset</h4>
        <p>Löydettyjen hankkeiden määrä: {{searchresults.length}}</p>
        <table class="col-md-12 table table-striped">
            <thead>
                <!-- TODO: Check the names for the ordering predicates. -->
                <tr>
                    <th class="col-md-1">
                        <a id="byRef" href="" ng-click="updateOrdering('project_ref')">
                            Tunnus
                        </a>
                    </th>
                    <th class="col-md-3">
                        <a id="byProject" href="" ng-click="updateOrdering('project_title')">
                            Hanke
                        </a>
                    </th>
                    <th class="col-md-3">
                        <a id="byOrg" href="" ng-click="updateOrdering('organisation.name')">
                            Järjestö
                        </a>
                    </th>
                    <th class="col-md-5">
                        <a id="byDescription" href="" ng-click="updateOrdering('description')">
                            Kuvaus
                        </a>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="result in results| orderBy: 'project_ref'">
                    <td>{{result.project_ref}}</td>
                    <td><a ng-href="/projects/{{result._id}}" target="_blank">
                            {{result.title}}</a></td>
                    <td><a ng-href="/organisations/{{result.organisation._id}}" target="_blank">{{result.organisation.name}}</a>
                    </td>
                    <td>{{result.description}}</td>
                </tr>
            </tbody>
        </table>
    </article>

</section>
