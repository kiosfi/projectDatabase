<section data-ng-controller="ProjectsController" data-ng-init="initEditing()">
    <a ng-href="/projects/{{project._id}}" class="btn btn-danger">Peruuta</a>
    <form name="projectEditForm" class="form-horizontal" role="form" data-ng-submit="update(projectEditForm.$valid)" novalidate>
        <h2>{{project.title}} ({{project.organisation.name}})</h2>
        <h2>Tietojen muokkaus</h2>
        <fieldset>
            <a href="" ng-click="showRegDetails = ! showRegDetails">Rekisteröinti -tilan tiedot</a>
            <div class="fs1" ng-show="showRegDetails">
                <div class="form-group col-md-6" ng-class="{
                        'has-error'
                        : projectEditForm.title.$invalid }">
                    <label class="col-md-3 control-label">Nimi</label>

                    <div class="col-md-9">
                        <input name="title" type="text" class="form-control" data-ng-model="project.title" id="title"
                               placeholder="Hanke" required>

                        <div ng-show="projectEditForm.title.$invalid" class="help-block">
                            <p ng-show="projectEditForm.title.$error.required">Nimi on pakollinen</p>
                        </div>
                    </div>

                </div>
                <div class="form-group col-md-6" ng-class="{
                        'has-error'
                        : projectEditForm.coordinator.$invalid }">
                    <label  class="col-md-3 control-label">Koordinaattori</label>

                    <div class="col-md-9">
                        <input name="coordinator" type="text" class="form-control" data-ng-model="project.coordinator" id="coordinator"
                               placeholder="Koordinaattori" required>
                        <div ng-show="projectEditForm.coordinator.$invalid" class="help-block">
                            <p ng-show="projectEditForm.coordinator.$error.required">Koordinaattori on pakollinen</p>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-6" >
                    <label for="description"
                           class="col-md-3 control-label">Kuvaus</label>
                    <div class="col-md-9">
                        <textarea name="description" data-ng-model="project.description" id="description"
                                  placeholder="Kuvaus" class="form-control" ></textarea>
                    </div>
                </div>

                <div class="form-group col-md-6" >
                    <label for="description_en" class="col-md-3 control-label">Kuvaus
                        (ENG)</label>

                    <div class="col-md-9">
                        <textarea name="description_en" data-ng-model="project.description_en" id="description_en"
                                  placeholder="Kuvaus englanniksi" class="form-control"></textarea>                       
                    </div>
                </div>

                <div class="form-group col-md-6">
                    <label class="col-md-3 control-label">Haettu avustus (paikallinen
                        valuutta)</label>

                    <div class="col-md-9">
                        <input name="appliedlocal" type="number" class="form-control"
                               data-ng-model="project.funding.applied_curr_local" id="appliedlocal"
                               placeholder="Haettu avustus (paikallinen)">                        
                    </div>
                </div>

                <div class="form-group col-md-6">
                    <label  class="col-md-3 control-label">Haettu avustus (EUR)</label>

                    <div class="col-md-9">
                        <input name="appliedeur" type="number" class="form-control"
                               data-ng-model="project.funding.applied_curr_eur" id="appliedeur"
                               placeholder="Haettu avustus (EUR)">                        
                    </div>
                </div>

                <div class="form-group col-md-6">
                    <label class="col-md-3 control-label">Kesto (kk)</label>

                    <div class="col-md-9">
                        <input name="duration" type="number" class="form-control"
                               data-ng-model="project.duration_months" id="duration" placeholder="Kesto (kk)">     
                    </div>
                </div>

                <div class="fs4">
                    <div class="form-group col-md-6">
                        <label for="background"
                               class="col-md-3 control-label">Tausta</label>
                        <div class="col-md-9">
                            <textarea name="background" data-ng-model="project.background" id="background"
                                      placeholder="Tausta" class="form-control"></textarea>
                        </div>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="beneficiaries" class="col-md-3 control-label">Hyödynsaajat
                            ja vastuunkantajat</label>

                        <div class="col-md-9">
                            <textarea name="beneficiaries" data-ng-model="project.beneficiaries" id="beneficiaries"
                                      placeholder="Hyödynsaajat ja vastuunkantajat" class="form-control"></textarea>
                        </div>
                    </div>

                    <div class="form-group col-md-6">
                        <label for="gender_aspect" class="col-md-3 control-label">Gender
                            analyysi</label>

                        <div class="col-md-9">
                            <textarea name="gender_aspect" data-ng-model="project.gender_aspect" id="gender_aspect"
                                      placeholder="Gender analyysi" class="form-control"></textarea>
                        </div>
                    </div>

                    <div class="form-group col-md-6">
                        <label for="project_goal" class="col-md-3 control-label">Päätavoite</label>

                        <div class="col-md-9">
                            <textarea name="project_goal" data-ng-model="project.project_goal" id="project_goal"
                                      placeholder="Päätavoite" class="form-control"></textarea>
                        </div>
                    </div>

                    <div class="form-group col-md-12">
                        <label mean-token="'create-methods'" class="col-md-2">Toimintatavat</label>
                        <div class="col-md-12" id="methodsSelection" data-ng-repeat="method in addedMethods">
                            <select id="methodSelect" data-ng-model="method.name">
                                <option data-ng-repeat="methodName in methodNames" value="{{methodName}}">{{methodName}}</option>
                            </select>

                            <select id="levelSelect" data-ng-model="method.level">
                                <option data-ng-repeat="methodLevel in methodLevels" value="{{methodLevel}}">{{methodLevel}}</option>
                            </select>
                            <div style="clear:both;">&nbsp;</div>
                            <textarea name="methodComment" data-ng-model="method.comment" id="methodComment"
                                      placeholder="Toimintatavan kuvaus" class="form-control" required></textarea>

                        </div>
                        <div style="clear:both;">&nbsp;</div>
                        <div class="col-md-12">
                            <input type="button" value="Lisää uusi" ng-click="addMethod();"/>
                            <input type="button" value="Poista viimeinen" ng-click="removeMethod();"/>
                        </div>
                    </div>

                    <div class="form-group col-md-6">
                        <label for="sustainability_risks"
                               class="col-md-3 control-label">Kestävyys ja arvio riskeistä</label>

                        <div class="col-md-9">
                            <textarea name="sustainability_risks" data-ng-model="project.sustainability_risks"
                                      id="sustainability_risks" placeholder="Kestävyys ja riskit" class="form-control"></textarea>
                        </div>
                    </div>

                    <div class="form-group col-md-6">
                        <label for="reporting_evaluation"
                               class="col-md-3 control-label">Raportointi ja evaluointi</label>

                        <div class="col-md-9">
                            <textarea name="reporting_evaluation" data-ng-model="project.reporting_evaluation"
                                      id="reporting_evaluation" placeholder="Raportointi ja evaluointi" class="form-control"></textarea>
                        </div>
                    </div>

                    <div class="form-group col-md-6">
                        <label for="other_donors_proposed"
                               class="col-md-3 control-label">Muualta haettu rahoitus</label>

                        <div class="col-md-9">
                            <textarea name="other_donors_proposed" data-ng-model="project.other_donors_proposed"
                                      id="other_donors_proposed" placeholder="Muu rahoitus" class="form-control"></textarea>
                        </div>
                    </div>
                    <div class="form-group col-md-6">
                        <label class="col-md-3 control-label">Vaikutusalue tai -maa</label>

                        <div class="col-md-9">
                            <input name="region" type="text" class="form-control" data-ng-model="project.region" id="region"
                                   placeholder="Vaikutusalue">
                        </div>
                    </div>
                    <div class="form-group col-md-6">
                        <label class="col-md-3 control-label">DAC-koodi</label>

                        <div class="col-md-9">
                            <input name="dac" type="text" class="form-control" data-ng-model="project.dac" id="dac"
                                   placeholder="DAC">
                        </div>
                    </div>
                </div>
        </fieldset>

        <fieldset ng-show="project.in_review.date">
            <a href="" ng-click="showInRevDetails = !showInRevDetails">Käsittelyssä -tilan tiedot</a>
            <div class="form-group col-md-12" ng-show="showInRevDetails">
                <label for="comments" class="col-md-2 control-label">Kommentit</label>
                <div class="col-md-10">
                    <textarea name="comments" type="text" class="form-control" data-ng-model="project.in_review.comments" id="comments" placeholder="Siirretty käsittelyyn"></textarea>
                </div>
            </div>
        </fieldset>

        <fieldset ng-show="project.approved.date">
            <a href="" ng-click="showApprDetails = !showApprDetails">Hyväksytty -tilan tiedot</a>
            <div ng-show="showApprDetails">
                <div class="form-group col-md-12">
                    <label for="approved_date" class="col-md-2">Hyväksytty pvm</label>
                    <div class="col-md-2"  ng-class="{
                    'has-error'
                            :  projectEditForm.approved_day.$invalid }">
                        <input name="approved_day" type="number" class="form-control" data-ng-model="approved_day" id="approved_day" placeholder="p" min="1">
                        <div ng-show="projectEditForm.approved_day.$invalid" class="help-block">
                            <p ng-show="projectEditForm.approved_day.$error.number">Päivän täytyy olla numero</p>
                        </div>
                    </div>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.approved_month.$invalid }">
                        <input name="approved_month" type="number" class="form-control" data-ng-model="approved_month" id="approved_month" placeholder="k" min="1">
                        <div ng-show="projectEditForm.approved_month.$invalid" class="help-block">
                            <p ng-show="projectEditForm.approved_month.$error.number">Kuukauden täytyy olla numero</p>
                        </div>
                    </div>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.approved_year.$invalid }">
                        <input name="approved_year" type="number" class="form-control" data-ng-model="approved_year" id="approved_year" placeholder="vvvv" min="1">
                        <div ng-show="projectEditForm.approved_year.$invalid" class="help-block">
                            <p ng-show="projectEditForm.approved_year.$error.number">Vuoden täytyy olla numero</p>
                        </div>
                    </div>
                    <div style="clear:both;">&nbsp;</div>
                </div>

                <div class="form-group col-md-12" ng-class="{
                'has-error'
                        :  projectEditForm.approved_by.$invalid }">
                    <label for="approved_by" class="col-md-2">Hyväksyjä</label>
                    <div class="col-md-10">
                        <select id="approved_by" data-ng-model="project.approved.approved_by" class='form-control' selected="project.approved.approved_by">
                            <option value="Toiminnanjohtaja">Toiminnanjohtaja</option>
                            <option value="Halko">Halko</option>
                            <option value="UM">UM</option>
                        </select>
                    </div>
                </div>

                <div class="form-group col-md-12">
                    <label for="board_notified" class="col-md-2">Tiedoksiannon päivämäärä</label>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.board_notified_day.$invalid }">
                        <input name="board_notified_day" type="number" class="form-control" data-ng-model="notified_day" id="board_notified_day" placeholder="p" min="1">
                        <div ng-show="projectEditForm.board_notified_day.$invalid" class="help-block">
                            <p ng-show="projectEditForm.board_notified_day.$error.number">Päivän täytyy olla numero</p>
                        </div>
                    </div>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.board_notified_month.$invalid }">
                        <input name="board_notified_month" type="number" class="form-control" data-ng-model="notified_month" id="board_notified_month" placeholder="k" min="1">
                        <div ng-show="projectEditForm.board_notified_month.$invalid" class="help-block">
                            <p ng-show="projectEditForm.board_notified_month.$error.number">Kuukauden täytyy olla numero</p>
                        </div>
                    </div>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.board_notified_year.$invalid }">
                        <input name="board_notified_year" type="number" class="form-control" data-ng-model="notified_year" id="board_notified_year" placeholder="vvvv" min="1">
                        <div ng-show="projectEditForm.board_notified_year.$invalid" class="help-block">
                            <p ng-show="projectEditForm.board_notified_year.$error.number">Vuoden täytyy olla numero</p>
                        </div>
                    </div>
                    <div style="clear:both;">&nbsp;</div>
                </div>

                <div class="form-group col-md-12">
                    <label for="granted_sum_eur" class="col-md-2">Myönnetty summa (euro)</label>

                    <div class="col-md-3" ng-class="{
                    'has-error'
                            :  projectEditForm.granted_sum_eur.$invalid }">
                        <input name="granted_sum_eur" type="number" class="form-control" data-ng-model="project.approved.granted_sum_eur" id="granted_sum_eur" placeholder="0">
                        <div ng-show="projectEditForm.granted_sum_eur.$invalid" class="help-block">
                            <p ng-show="projectEditForm.granted_sum_eur.$error.number">Summan täytyy olla numero</p>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-12">
                    <label mean-token="'create-themes'" class="col-md-2">Teemat</label>
                    <div class="col-md-12">
                        <table>
                            <tr ng-repeat="theme in themes">
                                <td><input
                                        type="checkbox"
                                        name="selectedThemes[]"
                                        value="{{theme}}"
                                        ng-checked="themeSelection.indexOf(theme) > - 1"
                                        ng-click="toggleThemeSelection(theme)"
                                        > {{theme}}</td>
                            </tr>
                        </table>
                    </div>
                </div>                  
            </div>
        </fieldset>

        <fieldset ng-show="project.rejected.date">
            <a href="" ng-click="showRejDetails = !showRejDetails">Hylätty -tilan tiedot</a>
            <div ng-show="showRejDetails">
                <div class="form-group col-md-12">
                    <label mean-token="'create-rejcategories'" class="col-md-3">Syyt</label>

                    <div class="col-md-12" id="rejSelection" data-ng-repeat="rej in addedRejections">
                        <select name="rejSelect" id="rejSelect" data-ng-model="rej.rejection">
                            <option data-ng-repeat="rejCat in rejcategories" value="{{rejCat}}">{{rejCat}}</option>
                        </select>
                    </div>

                    <div class="col-md-12">
                        <input id="addRej" type="button" value="Lisää uusi" ng-click="addRejection();"/>
                        <input id="remRej" type="button" value="Poista viimeinen" ng-click="removeRejection();"/>
                    </div>
                </div>

                <div class="form-group col-md-12">
                    <label for="comments" class="col-md-2">Kommentit</label>
                    <div class="col-md-10">
                        <textarea name="comments" type="text" class="form-control" data-ng-model="project.rejected.rejection_comments" id="comments" placeholder="Kommentit hylkäysperusteille"></textarea>
                    </div>
                </div>
            </div>
        </fieldset>

        <fieldset ng-show="project.signed.date">
            <a href="" ng-click="showSignDetails = !showSignDetails">Allekirjoitettu -tilan tiedot</a>
            <div ng-show="showSignDetails">
                <div class="form-group col-md-12">
                    <label for="signed_by" class="col-md-2">Allekirjoittaja</label>
                    <div class="col-md-10">
                        <input name="signed_by" type="text" class="form-control" data-ng-model="project.signed.signed_by" id="signed_by" placeholder="Sopimuksen allekirjoittajan nimi">
                    </div>

                </div>

                <div class="form-group col-md-12">
                    <label for="signed_date_day" class="col-md-2">Päivämäärä</label>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.signed_date_day.$invalid }">
                        <input name="signed_date_day" type="number" class="form-control" data-ng-model="signed_day" id="signed_date_day" placeholder="p" value="{{project.signed.signed_date| date : 'd'}}">
                        <div ng-show="projectEditForm.signed_date_day.$invalid" class="help-block">
                            <p ng-show="projectEditForm.signed_date_day.$error.number">Päivän täytyy olla numero</p>
                        </div>
                    </div>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.signed_date_month.$invalid }">
                        <input name="signed_date_month" type="number" class="form-control" data-ng-model="signed_month" id="signed_date_month" placeholder="k" value="{{project.signed.signed_date| date : 'M'}}">
                        <div ng-show="projectEditForm.signed_date_month.$invalid" class="help-block">
                            <p ng-show="projectEditForm.signed_date_month.$error.number">Kuukauden täytyy olla numero</p>
                        </div>
                    </div>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.signed_date_year.$invalid }">
                        <input name="signed_date_year" type="number" class="form-control" data-ng-model="signed_year" id="signed_date_year" placeholder="vvvv" value="{{project.signed.signed_date| date : 'yyyy'}}">
                        <div ng-show="projectEditForm.signed_date_year.$invalid" class="help-block">
                            <p ng-show="projectEditForm.signed_date_year.$error.number">Vuoden täytyy olla numero</p>
                        </div>
                    </div>
                    <div style="clear:both;">&nbsp;</div>
                </div>

                <label for="plannedPaymentSelection" class="col-md-3">Maksusuunnitelma</label>
                <div class="form-group col-md-12"><p>Myönnetty summa: {{project.approved.granted_sum_eur| currency : ""}} €</p></div>
                <div class="form-group col-md-12" id="plPayments">
                    <div class="col-md-12" name="plannedPaymentSelection" id="plannedPaymentSelection"data-ng-repeat="plannedPayment in plannedPayments">
                        <div>
                            <label for="plannedDay" class="col-md-2 control-label">Päivämäärä</label>
                            <div class="col-md-2" style="float:left;">
                                <input name="plannedDay" type="number" class="form-control" data-ng-model="plannedPayments[$index].planned_day" id="plannedDay" placeholder="p" min="1">
                            </div>
                            <div class="col-md-2" style="float:left;">
                                <input name="plannedMonth" type="number" class="form-control" data-ng-model="plannedPayments[$index].planned_month" id="plannedMonth" placeholder="k" min="1">
                            </div>
                            <div class="col-md-2" style="float:left;">
                                <input name="plannedYear" type="number" class="form-control" data-ng-model="plannedPayments[$index].planned_year" id="plannedYear" placeholder="vvvv" min="1">
                            </div>
                        </div>
                        <div style="clear:both;">&nbsp;</div>
                        <div>
                            <label for="plannedSumEUR" class="col-md-2 control-label">Summa (EUR)</label>
                            <div class="col-md-5">
                                <input name="plannedSumEUR" type="number" class="form-control" data-ng-model="plannedPayments[$index].sum_eur" id="plannedSumEUR" placeholder="Summa (EUR)" min="0">
                            </div>
                        </div>
                        <div style="clear:both;">&nbsp;</div>
                        <br>
                    </div>

                    <div class="col-md-12">
                        <input type="button" id="add-btn" value="Lisää uusi" ng-click="addPlannedPayment();"/>
                        <input type="button" value="Poista viimeinen" ng-click="removePlannedPayment();"/>
                    </div>

                </div>

                <label for="reportDeadlines" class="col-md-3">Raporttien eräpäivät</label>
                <div class="form-group col-md-12">

                    <div class="col-md-12" name="reportDeadlines" id="reportDeadlines" data-ng-repeat="deadline in deadlines">
                        <label for="dlRep" class="col-md-2 control-label">Raportti</label>
                        <div class="col-md-5" style="float:left;">
                            <input name="dlRep" type="text" class="form-control" data-ng-model="deadlines[$index].report" id="dlRep" placeholder="Raportti">
                        </div>
                        <div style="clear:both;">&nbsp;</div>
                        <div name="dlDate">
                            <label for="dlDay" class="col-md-2 control-label">Eräpäivä</label>
                            <div class="col-md-2">
                                <input name="dlDay" type="number" class="form-control" data-ng-model="deadlines[$index].deadline_day" id="dlDay" placeholder="p" min="1">
                            </div>
                            <div class="col-md-2" style="float:left;">
                                <input name="dlMonth" type="number" class="form-control" data-ng-model="deadlines[$index].deadline_month" id="dlMonth" placeholder="k" min="1">
                            </div>
                            <div class="col-md-2" style="float:left;">
                                <input name="dlYear" type="number" class="form-control" data-ng-model="deadlines[$index].deadline_year" id="dlYear" placeholder="vvvv"  min="1">
                            </div>
                            <div style="clear:both;">&nbsp;</div>
                            <br>
                        </div>
                    </div>

                    <div class="col-md-12">
                        <input type="button" id="add-btn2" value="Lisää uusi" ng-click="addDeadline();"/>
                        <input type="button" value="Poista viimeinen" ng-click="removeDeadline();"/>
                    </div>
                </div>
            </div>
        </fieldset>

        <fieldset ng-show="project.intermediary_reports.length > 0">
            <a href="" ng-click="showIntRepDetails = !showIntRepDetails">Väliraportti -tilan tiedot</a>
            <div ng-show="showIntRepDetails">
                <div data-ng-repeat="intreport in int_reports">
                    <h4>{{intreport.reportNumber}}. väliraportti</h4>                    

                    <p class="col-md-12 strong-title comment-form-div">Toimintatavat ja niiden toteutuminen</p>
                    <div class="form-group col-md-12" ng-repeat="method in project.approved.methods">
                        <div class="col-md-4">
                            {{method.name}} <br>- {{method.level}}
                        </div>
                        <div class="col-md-8">
                            <textarea name="intRMethods" type="text" class="form-control" data-ng-model="intreport.methods[project.approved.methods.indexOf(method)]" id="intRMethods" placeholder="Kommentteja"></textarea>
                        </div>
                    </div>

                    <p class="col-md-12 strong-title comment-form-div">Tavoitteet ja niiden toteutuminen</p>
                    <div class="form-group col-md-12">
                        <div class="col-md-4">
                            <p>{{project.project_goal}}</p>
                        </div>
                        <div class="col-md-8">
                            <textarea name="objComments" type="text" class="form-control" data-ng-model="intreport.objectives" id="objComments" placeholder="Kommentteja tavoitteiden toteutumisesta"></textarea>
                        </div>
                    </div>

                    <div class="form-group col-md-12">
                        <label for="overallKios" class="col-md-2">KIOS:in kokonaisarvio</label>
                        <div class="col-md-10">
                            <textarea name="overallKios" type="text" class="form-control" data-ng-model="intreport.overall_rating_kios"
                                      id="overallKios" placeholder="KIOS:in arvio"></textarea>
                        </div>
                    </div>


                    <div class="form-group col-md-12">
                        <label for="comments" class="col-md-2">Muut kommentit</label>
                        <div class="col-md-10">
                            <textarea name="intRComments" type="text" class="form-control" data-ng-model="intreport.comments" id="intRcomments" placeholder="Muut raportin kommentit"></textarea>
                        </div>
                    </div>

                    <div class="form-group col-md-12">
                        <label for="intRApprovedBy" class="col-md-2">Hyväksyjä</label>
                        <div class="col-md-10">
                            <input name="intRApprovedBy" type="text" class="form-control" data-ng-model="intreport.approved_by" id="intRApprovedBy" placeholder="Väliraportin hyväksyjä">
                        </div>
                    </div>

                    <div class="form-group col-md-12">
                        <label for="intRDateAppr" class="col-md-2">Hyväksymis pvm</label>

                        <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.intRDateAppr_day.$invalid }">
                            <input name="intRDateAppr_day" type="number" class="form-control" data-ng-model="intreport.date_day" id="intRDateAppr_day" placeholder="p" min="1">
                            <div ng-show="projectEditForm.intRDateAppr_day.$invalid" class="help-block">
                                <p ng-show="projectEditForm.intRDateAppr_day.$error.number">Päivän täytyy olla numero</p>
                            </div>
                        </div>
                        <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.intRDateAppr_month.$invalid }">
                            <input name="intRDateAppr_month" type="number" class="form-control" data-ng-model="intreport.date_month" id="intRDateAppr_month" placeholder="k" min="1">
                            <div ng-show="projectEditForm.intRDateAppr_month.$invalid" class="help-block">
                                <p ng-show="projectEditForm.intRDateAppr_month.$error.number">Kuukauden täytyy olla numero</p>
                            </div>
                        </div>
                        <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.intRDateAppr_year.$invalid }">
                            <input name="intRDateAppr_year" type="number" class="form-control" data-ng-model="intreport.date_year" id="intRDateAppr_year" placeholder="vvvv" min="1">
                            <div ng-show="projectEditForm.intRDateAppr_year.$invalid" class="help-block">
                                <p ng-show="projectEditForm.intRDateAppr_year.$error.number">Vuoden täytyy olla numero</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </fieldset>

        <fieldset ng-show="project.end_report.date">
            <a href="" ng-click="showEndRepDetails = !showEndRepDetails">Loppuraportti -tilan tiedot</a>

            <div ng-show="showEndRepDetails">
                <div class="form-group col-md-12">
                    <label for="audit_date" class="col-md-2">Tilintarkastus pvm</label>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            : projectEditForm.audit_day.$invalid }">
                        <input name="audit_day" type="number" class="form-control" data-ng-model="audit_day" id="audit_day" placeholder="p" min="1">
                        <div ng-show="projectEditForm.audit_day.$invalid" class="help-block">
                            <p ng-show="projectEditForm.audit_day.$error.number">Päivän täytyy olla numero</p>
                        </div>
                    </div>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.audit_month.$invalid }">
                        <input name="audit_month" type="number" class="form-control" data-ng-model="audit_month" id="audit_month" placeholder="k" min="1">
                        <div ng-show="projectEditForm.audit_month.$invalid" class="help-block">
                            <p ng-show="projectEditForm.audit_month.$error.number">Kuukauden täytyy olla numero</p>
                        </div>
                    </div>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            : projectEditForm.audit_year.$invalid }">
                        <input name="audit_year" type="number" class="form-control" data-ng-model="audit_year" id="audit_year" placeholder="vvvv" min="1">
                        <div ng-show="projectEditForm.audit_year.$invalid" class="help-block">
                            <p ng-show="projectEditForm.audit_year.$error.number">Vuoden täytyy olla numero</p>
                        </div>
                    </div>
                </div>
                <div style="clear:both;">&nbsp;</div>
                <div class="form-group col-md-12">
                    <label for="audit_review" class="col-md-2">Tilintarkastuksen Arvio</label>
                    <div class="col-md-8">
                        <textarea name="audit_review" type="text" class="form-control" data-ng-model="project.end_report.audit.review" id="audit_review" placeholder="Arvio tilintarkastuksesta"></textarea>
                    </div>
                </div>

                <p class="col-md-12 strong-title comment-form-div">Toimintatavat ja niiden toteutuminen</p>
                <div class="form-group col-md-12" ng-repeat="method in project.approved.methods">
                    <div class="col-md-4">
                        {{method.name}} <br>- {{method.level}}
                    </div>
                    <div class="col-md-8">
                        <textarea name="er_methods" type="text" class="form-control" data-ng-model="project.end_report.methods[project.approved.methods.indexOf(method)]" id="er_methods" placeholder="Kommentteja"></textarea>
                    </div>

                </div>

                <p class="col-md-12 strong-title comment-form-div">Kokonaistavoitteen toteutuminen</p>
                <div class="form-group col-md-12">
                    <div class="col-md-4">
                        <p>{{project.project_goal}}</p>
                    </div>
                    <div class="col-md-8">
                        <textarea name="objectivesComments" type="text" class="form-control" data-ng-model="project.end_report.objective" id="objectivesComments" placeholder="Kommentteja kokonaistavoitteen toteutumisesta"></textarea>
                    </div>
                </div>
                <div class="form-group col-md-12">
                    <p class="col-md-12 strong-title comment-form-div">KIOS:in kokonaisarvio</p>
                    <div class="col-md-12">
                        <textarea name="gen_review" type="text" class="form-control" data-ng-model="project.end_report.general_review" id="gen_review" placeholder="Muut raportin kommentit"></textarea>
                    </div>
                </div>

                <div class="form-group col-md-12">
                    <label for="approvedBy" class="col-md-2">Hyväksyjä</label>
                    <div class="col-md-8">
                        <input name="approvedBy" type="text" class="form-control" data-ng-model="project.end_report.approved_by" id="approvedBy" placeholder="Hyväksyjän nimi">
                    </div>
                </div>
                <div class="form-group col-md-12">
                    <label for="audit_day" class="col-md-2">Hyväksymis pvm</label>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.er_approved_day.$invalid }">
                        <input name="er_approved_day" type="number" class="form-control" data-ng-model="er_approved_day" id="er_approved_day" placeholder="p" min="1">
                        <div ng-show="projectEditForm.er_approved_day.$invalid" class="help-block">
                            <p ng-show="projectEditForm.er_approved_day.$error.number">Päivän täytyy olla numero</p>
                        </div>
                    </div>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.er_approved_month.$invalid }">
                        <input name="er_approved_month" type="number" class="form-control" data-ng-model="er_approved_month" id="er_approved_month" placeholder="k" min="1">
                        <div ng-show="projectEditForm.er_approved_month.$invalid" class="help-block">
                            <p ng-show="projectEditForm.er_approved_month.$error.number">Kuukauden täytyy olla numero</p>
                        </div>
                    </div>
                    <div class="col-md-2" style="float:left;" ng-class="{
                    'has-error'
                            :  projectEditForm.er_approved_year.$invalid }">
                        <input name="er_approved_year" type="number" class="form-control" data-ng-model="er_approved_year" id="er_approved_year" placeholder="vvvv" min="1">
                        <div ng-show="projectEditForm.er_approved_year.$invalid" class="help-block">
                            <p ng-show="projectEditForm.er_approved_year.$error.number">Vuoden täytyy olla numero</p>
                        </div>
                    </div>
                    <div style="clear:both;">&nbsp;</div>
                </div>


                <p class="col-md-12 strong-title comment-form-div">Muut kommentit</p>
                <div class="col-md-12">
                    <textarea name="comments" type="text" class="form-control" data-ng-model="project.end_report.comments" id="comments" placeholder="Muut raportin kommentit"></textarea>
                </div>
            </div>
        </fieldset>

        <fieldset ng-show="project.ended.date">
            <a href="" ng-click="showEndedDetails = !showEndedDetails">Päättynyt -tilan tiedot</a>
            <div ng-show="showEndedDetails">
                <div class="form-group col-md-12">
                    <div>
                        <label for="endDay" class="col-md-2 control-label">Päivämäärä</label>
                        <div class="col-md-2" style="float:left;">
                            <input name="endDay" type="number" class="form-control" data-ng-model="end_day" id="endDay" placeholder="p">
                        </div>
                        <div class="col-md-2" style="float:left;">
                            <input name="endMonth" type="number" class="form-control" data-ng-model="end_month" id="endMonth" placeholder="k">
                        </div>
                        <div class="col-md-2" style="float:left;">
                            <input name="endYear" type="number" class="form-control" data-ng-model="end_year" id="endYear" placeholder="vvvv">
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-12">
                    <label for="approved_by" class="col-md-2"> Hyväksyjä</label>
                    <div class="col-md-10">
                        <select id="approved_by" data-ng-model="project.ended.approved_by" class='form-control'>
                            <option value="toiminnanjohtaja">Toiminnanjohtaja</option>
                            <option value="hallitus">Hallitus</option>
                        </select>
                    </div>
                </div>

                <div class="form-group col-md-12">
                    <div>
                        <label for="notifiedDay" class="col-md-2">Tiedoksiannnon päivämäärä</label>
                        <div class="col-md-2" style="float:left;">
                            <input name="endNotifiedDay" type="number" class="form-control" data-ng-model="end_notified_day" id="notifiedDay" placeholder="p">
                        </div>
                        <div class="col-md-2" style="float:left;">
                            <input name="endNotifiedMonth" type="number" class="form-control" data-ng-model="end_notified_month" id="notifiedMonth" placeholder="k">
                        </div>
                        <div class="col-md-2" style="float:left;">
                            <input name="endNotifiedYear" type="number" class="form-control" data-ng-model="end_notified_year" id="notifiedYear" placeholder="vvvv">
                        </div>
                    </div>

                </div>

                <div class="form-group col-md-12">
                    <label for="comments" class="col-md-2">Muut kommentit</label>
                    <div class="col-md-10">
                        <textarea name="endComments" type="text" class="form-control" data-ng-model="project.ended.other_comments" id="comments" placeholder="Muut päättämiseen liittyvät kommentit"></textarea>
                    </div>

                </div>
            </div>
        </fieldset>


        <!--    <div class="form-group" ng-class="{ 'has-error' : submitted && projectForm.title.$invalid }">
              <label mean-token="'edit-title'" for="title" class="col-md-2 control-label">Title</label>
              <div class="col-md-10">
                <input name="title" type="text" class="form-control" data-ng-model="project.title" id="title" placeholder="Title" required>
                <div ng-show="submitted && projectForm.title.$invalid" class="help-block">
                  <p ng-show="projectForm.title.$error.required">Title is required</p>
                </div>
              </div>
        
            </div>
            <div class="form-group" ng-class="{ 'has-error' : submitted && projectForm.status.$invalid }">
              <label mean-token="'edit-status'" for="status" class="col-md-2 control-label">Status</label>
              <div class="col-md-10">
                <input name="status" type="text" class="form-control" data-ng-model="project.status" id="status" placeholder="Status" required>
                <div ng-show="submitted && projectForm.status.$invalid" class="help-block">
                  <p ng-show="projectForm.status.$error.required">Status is required</p>
                </div>
              </div>
        
            </div>
        -->
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <button mean-token="'edit-submit'" type="submit" class="btn btn-default"
                        ng-disabled="projectEditForm.$invalid">Tallenna</button>
            </div>
        </div>
    </form>
</section>
