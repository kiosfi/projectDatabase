<article data-ng-controller="ProjectsController" data-ng-init="findOne()">
    <style>
        td {padding-left: 3em;}
    </style>
    <div>
        <article id="header">
            <h2 id="projtitle">
                <span class="name">
                    {{project.project_ref}}: {{project.title}}
                </span>
                <span>
                    <a class="btn-lg" id="delete"
                       data-ng-click="confirmProjectDeletion(project);">
                        <i class="glyphicon glyphicon-trash"></i>
                    </a>
                    <a ng-href="/projects/{{project._id}}/edit" class="btn-lg"
                       id="edit">
                        <span class="glyphicon glyphicon-edit"></span>
                    </a>

                </span>
            </h2>
            <h3>Koordinaattori: <a href="">{{project.coordinator}}</a>
                <span class="tila" id="state">{{project.state}}</span>
            </h3>

            <span><a ng-click="showEditLog = !showEditLog"
                     ng-show="project.updated.length > 0">
                    Tietoja muokattu
                </a>
                <ul ng-show="showEditLog">
                    <li data-ng-repeat="update in project.updated">
                        {{update.time| date: 'd.M.yyyy HH:mm'}};
                        muokkaajana {{update.user}}
                    </li>
                </ul></span>
        </article>
    </div>
    <div>
        <ul id="menu" class="col-md-3 nav nav-list" style="position: fixed">
            <li>
                <label><a href="#header">Hanke</a></label>
                <ul>
                    <li><a href="#summary">Perustiedot</a></li>
                    <li><a href="#description">Kuvaus</a></li>
                    <li><a href="#details">Lisätiedot</a></li>
                </ul>
            </li>
            <li>
                <label><a href="#organisation">Järjestö</a></label>
            </li>
            <li>
                <label><a href="#assessment">KIOS:n arvio</a></label>
            </li>
            <li>
                <label><a href="#schedule">Aikataulu</a></label>
            </li>
            <li>
                <label><a href="#payments">Maksatus</a></label>
                <ul>
                    <li><a href="#addPayment">Maksun lisäys</a></li>
                </ul>
            </li>
            <li>
                <label><a href="#checklist">Vaaditut liitteet</a></label>
                <ul>
                    <li><a href="#appendices">Tallennetut liitteet</a></li>
                    <li><a href="#addAppendix">Liitteen lisäys</a></li>
                </ul>
            </li>
        </ul>
        <div style="margin-left: 160px">
            <article ng-show="project.approved" class="proj-article">
                <h4>Teemat</h4>
                <button type="button" class="proj-content"
                        data-ng-model="project.approved.themes"
                        data-ng-repeat="theme in project.approved.themes"
                        disabled>
                    <span class="glyphicon glyphicon-tag">
                    </span> {{theme}}
                </button>
            </article>
            <article class="proj-article" ng-show="state.next.length !== 0
                                    && project.state !== 'hylätty'
                                    && project.state !== 'päättynyt'"
                     data-ng-init="findState()">
                <form name="stateForm" class="states"
                      data-ng-submit="changeState(project.changeTo);">
                    <label for="stateSelect">Siirry tilaan</label>
                    <select id="stateSelect" data-ng-model="project.changeTo">
                        <option data-ng-repeat="next_state in state.next_states"
                                value="{{next_state}}">{{next_state}}</option>
                    </select>
                    <button type="submit" class="btn-xs" id="st">
                        <span class="glyphicon glyphicon-arrow-right"></span>
                    </button>
                </form>
            </article>
            <article id="summary" class="proj-article">
                <h4>Perustiedot</h4>
                <div class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">Turvaluokitus</div>
                    <div class="col-md-9">{{project.security_level}}</div>
                </div>
                <div ng-show="nonEmpty(project.region)"
                     class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">Alue</div>
                    <div class="col-md-9">{{project.region}}</div>
                </div>
                <div ng-show="nonEmpty(project.dac)"
                     class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">DAC</div>
                    <div class="col-md-9">{{project.dac}}</div>
                </div>
                <div ng-show="nonEmpty(project.state)"
                     class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">Tila</div>
                    <div class="col-md-9">{{project.state}}</div>
                </div>
                <div class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">Kirjattu</div>
                    <div class="col-md-9">{{project.reg_date| date:'d.M.yyyy': 'UTC'}}</div>
                </div>
                <div ng-show="project.approved.granted_sum_eur"
                     class="ng-hide proj-content col-md-12">
                    <div class="col-md-3 mini-header">Myönnetty EUR</div>
                    <div class="col-md-9">{{project.approved.granted_sum_eur| currency : ""}}</div>
                </div>
                <div ng-show="!project.approved.granted_sum.granted_curr_eur &&
                                        project.funding.applied_curr_eur >= 0"
                     class="ng-hide proj-content col-md-12">
                    <div class="col-md-3 mini-header">Haettu EUR</div>
                    <div class="col-md-9">{{project.funding.applied_curr_eur| currency : ""}}</div>
                </div>
                <div ng-show="!project.approved.granted_sum.granted_curr_eur &&
                                        project.funding.applied_curr_local"
                     class="ng-hide proj-content col-md-12">
                    <div class="col-md-3 mini-header">Haettu paik.</div>
                    <div class="col-md-9">{{project.funding.applied_curr_local| currency : ""}}</div>
                </div>
                <div ng-show="project.duration_months >= 0"
                     class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">Kesto</div>
                    <div class="col-md-9">{{project.duration_months}} kk</div>
                </div>
                &nbsp;
            </article>
            <article id="description" class="proj-article">
                <h4>Kuvaus</h4>
                <div class="proj-content">
                    {{project.description}}
                </div>
                &nbsp;
            </article>
            <article id="organisation" class="proj-article">
                <h4>Järjestö</h4>
                <div ng-show="nonEmpty(project.organisation.name)"
                     class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">Nimi</div>
                    <div class="col-md-9">
                        <a data-ng-href="/organisations/{{project.organisation._id}}">
                            {{project.organisation.name}}</a>
                    </div>
                </div>
                <div ng-show="nonEmpty(project.organisation.
                                        representative.name)"
                     class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">Edustaja</div>
                    <div class="col-md-9">
                        {{project.organisation.representative.name}}
                    </div>
                </div>
                <div class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">Osoite</div>
                    <div class="col-md-9">
                        {{project.organisation.address.street}}<br>
                        {{project.organisation.address.postal_code}}
                        {{project.organisation.address.city}}<br>
                        {{project.organisation.address.country}}
                    </div>
                </div>
                <div ng-show="nonEmpty(project.organisation.tel)"
                     class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">Puhelinnumero</div>
                    <div class="col-md-9">{{project.organisation.tel}}</div>
                </div>
                <div ng-show="nonEmpty(project.organisation.email)"
                     class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">Sähköposti</div>
                    <div class="col-md-9">{{project.organisation.email}}</div>
                </div>
                <div ng-show="nonEmpty(project.organisation.website)"
                     class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">Websivut</div>
                    <div class="col-md-9">{{project.organisation.website}}</div>
                </div>
                &nbsp;
            </article>
            <article id="details" class="proj-article">
                <h4>Lisätiedot</h4>
                <div id="appinfo" class="proj-content">
                    <div class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">
                            Suunnitellut toimintatavat
                        </div>
                        <div class="col-md-8">
                            <div ng-repeat="method in project.methods">
                                <em>{{method.name}}</em> ({{method.level}})
                                <p class="proj-subcontent">{{method.comment}}</p>
                            </div>
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.background)"
                         class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">Ihmisoikeuskonteksti</div>
                        <div class="col-md-8">
                            {{project.background}}
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.project_goal)"
                         class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">Hankkeen tavoite</div>
                        <div class="col-md-8">
                            {{project.project_goal}}
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.target_group)"
                         class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">
                            Kohderyhmä
                        </div>
                        <div class="col-md-8">
                            {{project.target_group}}
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.gender_aspect)"
                         class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">
                            Tasa-arvonäkökulma ja muut läpileikkaavat teemat
                        </div>
                        <div class="col-md-8">
                            {{project.gender_aspect}}
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.vulnerable_groups)"
                         class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">
                            Haavoittuvimpien ryhmien huomioon ottaminen
                        </div>
                        <div class="col-md-8">
                            {{project.vulnerable_groups}}
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.sustainability_risks)"
                         class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">Riskit</div>
                        <div class="col-md-8">
                            {{project.sustainability_risks}}
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.reporting_evaluation)"
                         class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">
                            Evaluointi ja vaikuttavuuden arviointi
                        </div>
                        <div class="col-md-8">
                            {{project.reporting_evaluation}}
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.budget)"
                         class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">Budjetti</div>
                        <div class="col-md-8">
                            {{project.budget}}
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.other_donors_proposed)"
                         class="col-md-12">
                        <div class="col-md-4 mini-header">Muualta haettu rahoitus</div>
                        <div class="col-md-8">
                            {{project.other_donors_proposed}}
                        </div>
                    </div>
                </div>
                &nbsp;
            </article>
            <article id="assessment" class="proj-article">
                <h4>KIOS:n arvio</h4>
                <div class="proj-content">
                    <div ng-show="nonEmpty(project.fitness)"
                         class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">
                            Sopivuus KIOS:n strategiaan
                        </div>
                        <div class="col-md-8">
                            {{project.fitness}}
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.capacity)"
                         class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">
                            Järjestön kapasiteetti ja asiantuntemus
                        </div>
                        <div class="col-md-8">
                            {{project.capacity}}
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.feasibility)"
                         class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">
                            Toteutettavuus ja riskit
                        </div>
                        <div class="col-md-8">
                            {{project.feasibility}}
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.effectiveness)"
                         class="col-md-12" style="margin-bottom: 1em">
                        <div class="col-md-4 mini-header">
                            Tuloksellisuus, vaikutukset ja vaikuttavuus
                        </div>
                        <div class="col-md-8">
                            {{project.effectiveness}}
                        </div>
                    </div>
                    <div ng-show="nonEmpty(project.proposed_funding)"
                         class="col-md-12">
                        <div class="col-md-4 mini-header">Ehdotus</div>
                        <div class="col-md-8">
                            {{project.proposed_funding}}
                        </div>
                    </div>
                    &nbsp;
                </div>
            </article>
            <article id="schedule" class="proj-article">
                <h4>Aikataulu</h4>
                <section class="proj-content"
                         ng-show="project.signed.intreport_deadlines.length > 0">
                    <h5>Raporttien eräpäivät</h5>
                    <div ng-repeat="deadline in project.signed.intreport_deadlines" class="proj-subcontent col-md-12">
                        <div class="col-md-3 mini-header">
                            {{deadline.report}}
                        </div>
                        <div class="col-md-9">
                            {{deadline.date| date: 'd.M.yyyy': 'UTC'}}
                        </div>
                    </div>
                    &nbsp;
                </section>
                <section  class="proj-content">
                    <section ng-show="project.in_review.date">
                        <div class="col-md-12">
                            <div class="col-md-3 mini-header">
                                Rekisteröity käsittelyyn
                            </div>
                            <div class="col-md-2">
                                {{project.in_review.date| date:'d.M.yyyy':
                                            'UTC'}}
                            </div>
                            <div class="col-md-1">
                                <button class="btn small-btn"
                                        onclick="toggleCollapse('reviewinfo')">
                                    Tiedot</button>
                            </div>
                            <div class="col-md-6">
                                <a ng-href="/projects/{{project._id}}/regreport/{{intreport.reportNumber}}"
                                   class="btn large-btn">Näytä raportti</a>
                            </div>
                        </div>
                        <div id="reviewinfo" class="proj-subcontent col-md-12"
                             style="display: none">
                            <div class="col-md-3 mini-header">
                                Tiedot lisäsi
                            </div>
                            <div class="col-md-9">{{project.in_review.user}},
                                {{project.in_review.date|
                                                    date:'d.M.yyyy, HH:mm':
                                                    'UTC'}}</div>
                            <div class="col-md-3 mini-header">Kommentit</div>
                            <div class="col-md-9">
                                {{project.in_review.comments}}
                            </div>
                        </div>
                        &nbsp;
                    </section>
                    <section ng-show="project.approved.date">
                        <div class="col-md-12">
                            <div class="col-md-3 mini-header">
                                Rekisteröity hyväksytyksi
                            </div>
                            <div class="col-md-2">
                                {{project.approved.date| date:'d.M.yyyy':'UTC'}}
                            </div>
                            <div class="col-md-7">
                                <button class="btn small-btn"
                                        onclick="toggleCollapse('approvedinfo')">
                                    Tiedot</button>
                            </div>
                        </div>
                        <div id="approvedinfo" class="proj-subcontent col-md-12"
                             style="display: none">
                            <div class="col-md-3 mini-header">
                                Tiedot lisäsi
                            </div>
                            <div class="col-md-9">{{project.approved.user}},
                                {{project.approved.date|
                                                    date:'d.M.yyyy, HH:mm':
                                                    'UTC'}}</div>
                            <div class="col-md-3 mini-header">Hyväksyjä</div>
                            <div class="col-md-9">
                                {{project.approved.approved_by}}
                            </div>
                            <div class="col-md-3 mini-header">
                                Hyväksymispäivä
                            </div>
                            <div class="col-md-9">
                                {{project.approved.approved_date| date:
                                                'd.M.yyyy':'UTC'}}
                            </div>
                            <div class="col-md-3 mini-header">
                                Hallitukselle tiedoksi
                            </div>
                            <div class="col-md-9">
                                {{project.approved.board_notified| date:
                                                'd.M.yyyy':'UTC'}}
                            </div>
                            <div class="col-md-3 mini-header">
                                Hyväksytty summa
                            </div>
                            <div class="col-md-9">
                                {{project.approved.granted_sum_eur|
                                                currency : ""}} EUR
                            </div>
                            <div class="col-md-3 mini-header">Teemat</div>
                            <div class="col-md-9">
                                <span data-ng-repeat="theme in project.approved.
                                                    themes">{{theme}}<br></span>
                            </div>
                        </div>
                        &nbsp;
                    </section>
                    <section ng-show="project.rejected.date">
                        <div class="col-md-12">
                            <div class="col-md-3 mini-header">
                                Rekisteröity hylätyksi
                            </div>
                            <div class="col-md-2">
                                {{project.rejected.date| date:'d.M.yyyy': 'UTC'}}
                            </div>
                            <div class="col-md-7">
                                <button class="btn small-btn"
                                        onclick="toggleCollapse('rejectedinfo')">
                                    Tiedot
                                </button>
                            </div>
                        </div>
                        <div id="rejectedinfo"
                             class="proj-subcontent col-md-12"
                             style="display: none">
                            <div class="col-md-3 mini-header">Tiedot lisäsi</div>
                            <div class="col-md-9">{{project.rejected.user}},
                                {{project.rejected.date|
                                                    date:'d.M.yyyy, HH:mm':
                                                    'UTC'}}</div>
                            <div class="col-md-3 mini-header">Hylkäyssyyt</div>
                            <div class="col-md-9">
                                <ul>
                                    <li ng-repeat="rej in project.
                                                        rejected.rejection_categories">
                                        {{rej.rejection}}
                                    </li>
                                </ul>
                            </div>
                            <div class="col-md-3 mini-header">Kommentit</div>
                            <div class="col-md-9">
                                {{project.rejected.rejection_comments}}
                            </div>
                        </div>
                        &nbsp;
                    </section>
                    <section ng-show="project.signed.date">
                        <div class="col-md-12">
                            <div class="col-md-3 mini-header">
                                Rekisteröity allekirjoitetuksi
                            </div>
                            <div class="col-md-2">
                                {{project.signed.date| date:'d.M.yyyy': 'UTC'}}
                            </div>
                            <div class="col-md-7">
                                <button class="btn small-btn"
                                        onclick="toggleCollapse('signedinfo')">
                                    Tiedot
                                </button>
                            </div>
                        </div>
                        <div id="signedinfo" class="proj-subcontent col-md-12"
                             style="display: none">
                            <div class="col-md-3 mini-header">Tiedot lisäsi</div>
                            <div class="col-md-9">{{project.signed.user}},
                                {{project.signed.date|
                                                date:'d.M.yyyy, HH:mm': 'UTC'}}
                            </div>
                            <div class="col-md-3 mini-header">Allekirjoitettu</div>
                            <div class="col-md-9">{{project.signed.signed_by}},
                                {{project.signed.signed_date|
                                                    date:'d.M.yyyy': 'UTC'}}</div>
                        </div>
                        &nbsp;
                    </section>
                    <section ng-show="project.intermediary_reports.length > 0">
                        <div ng-repeat="intreport in project.intermediary_reports">
                            <div class="col-md-12">
                                <div class="col-md-3 mini-header">
                                    {{intreport.reportNumber}}. väliraportti
                                    rekisteröity
                                </div>
                                <div class="col-md-2">
                                    {{intreport.date| date:'d.M.yyyy': 'UTC'}}
                                </div>
                                <div class="col-md-1">
                                    <button class="btn small-btn"
                                            ng-click="showIntDetails =
                                                                    !showIntDetails">
                                        Tiedot
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <a ng-href="/projects/{{project._id}}/intreport/{{intreport.reportNumber}}"
                                       class="btn large-btn">Näytä raportti</a>
                                </div>
                            </div>
                            <div ng-show="showIntDetails"
                                 class="proj-subcontent col-md-12">
                                <div class="col-md-3 mini-header">
                                    Tiedot lisäsi
                                </div>
                                <div class="col-md-9">{{intreport.user}},
                                    {{intreport.date|
                                                        date:'d.M.yyyy, HH:mm':
                                                        'UTC'}}</div>
                                <div class="col-md-3 mini-header">
                                    Raportin esitti
                                </div>
                                <div class="col-md-9">{{intreport.approved_by}},
                                    {{intreport.date_approved|
                                                        date : 'd.M.yyyy':
                                                        'UTC'}}</div>
                            </div>
                            <p ng-show="intreport.processed === true">
                                Väliraportti on käsitelty.
                            </p>
                            &nbsp;
                        </div>
                    </section>
                    <section ng-show="project.end_report.date">
                        <div class="col-md-12">
                            <div class="col-md-3 mini-header">
                                Loppuraportti rekisteröity
                            </div>
                            <div class="col-md-2">
                                {{project.end_report.date| date:'d.M.yyyy':'UTC'}}
                            </div>
                            <div class="col-md-1">
                                <button class="btn small-btn"
                                        ng-click="showEndDetails =
                                                            !showEndDetails">
                                    Tiedot
                                </button>
                            </div>
                            <div class="col-md-6">
                                <a ng-href="/projects/endReport/{{project._id}}"
                                   class="btn large-btn">Näytä raportti</a>
                            </div>
                        </div>
                        <div ng-show="showEndDetails"
                             class="proj-subcontent col-md-12">
                            <div class="col-md-3 mini-header">
                                Tiedot lisäsi
                            </div>
                            <div class="col-md-9">{{project.end_report.user}},
                                {{project.end_report.date|
                                                    date:'d.M.yyyy, HH:mm':
                                                    'UTC'}}</div>
                            <div class="col-md-3 mini-header">
                                Raportti hyväksytty
                            </div>
                            <div class="col-md-9">{{project.end_report.approved_by}},
                                {{project.end_report.date_approved|
                                                    date : 'd.M.yyyy': 'UTC'}}</div>
                        </div>
                        <p ng-show="project.end_report.processed === true">
                            Väliraportti on käsitelty.
                        </p>
                        &nbsp;
                    </section>
                    <section ng-show="project.ended.date">
                        <div class="col-md-12">
                            <div class="col-md-3 mini-header">
                                Rekisteröity päätetyksi
                            </div>
                            <div class="col-md-2">
                                {{project.ended.end_date| date:'d.M.yyyy':'UTC'}}
                            </div>
                            <div class="col-md-7"><button class="btn small-btn"
                                                          onclick="toggleCollapse('endedinfo')">
                                    Tiedot
                                </button></div>
                        </div>
                        <div id="endedinfo" class="proj-subcontent col-md-12">
                            <div class="col-md-3 mini-header">
                                Tiedot lisäsi
                            </div>
                            <div class="col-md-9">{{project.ended.user}},
                                {{project.ended.date|
                                                date:'d.M.yyyy, HH:mm': 'UTC'}}
                            </div>
                            <div class="col-md-3 mini-header">Hyväksyjä</div>
                            <div class="col-md-9">
                                {{project.ended.approved_by}}
                            </div>
                            <div class="col-md-3 mini-header">
                                Tiedotettu hallitukselle
                            </div>
                            <div class="col-md-9">{{project.ended.board_notified|
                                            date: 'd.M.yyyy': 'UTC'}}</div>
                            <div class="col-md-3 mini-header">
                                Muut päättämiseen liittyvät kommentit
                            </div>
                            <div class="col-md-9">
                                {{project.ended.other_comments}}
                            </div>
                        </div>
                        &nbsp;
                    </section>
                </section>
                &nbsp;
            </article>
            <article id="payments" class="proj-article">
                <h4>Maksatus</h4>
                <div class="proj-content col-md-12" style="margin-bottom: 1em">
                    <div class="col-md-3 mini-header">
                        <div ng-show="project.approved.granted_sum_eur">
                            Myönnetty avustus
                        </div>
                    </div>
                    <div class="col-md-2">
                        {{project.approved.granted_sum_eur| currency : ""}} EUR
                    </div>
                    <div class="col-md-7">
                        {{project.approved.approved_date| date:'d.M.yyyy': 'UTC'}}
                    </div>
                </div>
                <div class="proj-content">
                    <h5>Maksuaikataulu</h5>
                    <div ng-repeat="planned_payment in project.signed.
                                        planned_payments" class="col-md-12">
                        <div class="col-md-1"><em>{{project.signed.
                                                planned_payments.indexOf(planned_payment) + 1}}. erä</em></div>
                        <div class="col-md-2">{{planned_payment.sum_eur| currency : ""}} EUR</div>
                        <div class="col-md-9">{{planned_payment.date| date:'d.M.yyyy': 'UTC'}}</div>
                    </div>
                    &nbsp;
                </div>
                <div ng-show="project.payments.length > 0" class="proj-content">
                    <h5>Maksetut erät</h5>
                    <div ng-repeat="payment in project.payments"
                         class="col-md-12">
                        <div class="col-md-1">
                            <em id="paid">{{payment.payment_number}}. erä</em>
                        </div>
                        <div class="col-md-2">
                            {{payment.sum_eur| currency : ""}} EUR
                        </div>
                        <div class="col-md-9">
                            {{payment.payment_date| date:'d.M.yyyy': 'UTC'}}
                        </div>
                    </div>
                    &nbsp;
                </div>
                <div class="proj-content col-md-12" style="margin-bottom: 1em">
                    <div class="col-md-3 mini-header">Maksettu yhteensä</div>
                    <div class="col-md-9">
                        {{project.funding.paid_eur| currency : ""}} EUR
                    </div>
                </div>
                <div class="proj-content col-md-12">
                    <div class="col-md-3 mini-header">Jäljellä</div>
                    <div class="col-md-9">
                        {{project.funding.left_eur| currency : ""}} EUR
                    </div>
                </div>
                &nbsp;
            </article>
            <article id="addPayment" ng-show="project.signed.signed_by"
                     class="proj-article">
                <h4>Maksutiedon lisäys</h4>
                <form name="paymentForm" class="form-horizonal proj-content"
                      role="form"
                      data-ng-submit="addPaymentInfo(paymentForm.$valid)"
                      novalidate>
                    <div class="form-group col-xs-12" id="PaymentDate">
                        <label for="paymentDate" class="col-xs-2 control-label">
                            Päiväys
                        </label>
                        <div id="paymentDate">
                            <div class="col-xs-3" ng-class="{'has-error':
                                                paymentForm.paymentDay.$invalid }">
                                <input name="paymentDay" type="number"
                                       class="form-control"
                                       data-ng-model="payment_day"
                                       id="paymentDay" required
                                       />
                                <div ng-show="paymentForm.paymentDay.$invalid"
                                     class="help-block" >
                                    <p ng-show="paymentForm.paymentDay.$error.required">
                                        Päivä on pakollinen
                                    </p>
                                </div>
                            </div>
                            <div class="col-xs-3" ng-class="{
                                        'has-error'
                                                :paymentForm.paymentMonth.$invalid }">
                                <input name="paymentMonth" type="number"
                                       class="form-control"
                                       data-ng-model="payment_month"
                                       id="paymentMonth"
                                       required />
                                <div ng-show="paymentForm.paymentMonth.$invalid"
                                     class="help-block">
                                    <p ng-show="paymentForm.paymentMonth.$error.required">
                                        Kuukausi on pakollinen
                                    </p>
                                </div>
                            </div>
                            <div class="col-xs-3" ng-class="{
                                        'has-error'
                                                : paymentForm.paymentYear.$invalid }">
                                <input name="paymentYear" type="number"
                                       class="form-control"
                                       data-ng-model="payment_year"
                                       id="paymentYear"
                                       required />
                                <div ng-show="paymentForm.paymentYear.$invalid"
                                     class="help-block">
                                    <p ng-show="paymentForm.paymentYear.$error.required">
                                        Vuosi on pakollinen
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group col-xs-12" ng-class="{
                                'has-error': paymentForm.paymentSumEUR.$invalid}">
                        <label for="paymentSumEUR" class="col-xs-2 control-label">
                            Summa (EUR)
                        </label>
                        <div class="col-xs-4" >
                            <input name="paymentSumEUR" type="number"
                                   class="form-control"
                                   data-ng-model="project.payment.sum_eur"
                                   id="paymentSumEUR" placeholder="Summa (EUR)"
                                   required />
                        </div>
                        <div ng-show="paymentForm.paymentSumEUR.$invalid"
                             class="help-block">
                            <p ng-show="paymentForm.paymentSumEUR.$error.number">
                                Summan täytyy olla luku
                            </p>
                        </div>
                        <div ng-show="paymentForm.paymentSumEUR.$invalid"
                             class="help-block">
                            <p ng-show="paymentForm.paymentSumEUR.$error.required">
                                Kenttä on pakollinen
                            </p>
                        </div>
                    </div>
                    <div class="form-group col-xs-12">
                        <div class="col-xs-4">
                            <button type="submit" id="btn-pay"
                                    class="btn btn-default"
                                    ng-disabled="paymentForm.$invalid">
                                Tallenna
                            </button>
                        </div>
                    </div>
                </form>
                &nbsp;
            </article>
            <article id="checklist" class="proj-article">
                <h4>Vaaditut liitteet</h4>
                <div class="proj-article">
                    <form>
                        <div class="col-md-12">
                            <span class="col-md-3">
                                <label for="projBudget" >Hankebudjetti</label>
                            </span>
                            <span class="col-md-9">
                                <input type="checkbox" id="projBudget">
                            </span>
                        </div>
                        <div class="col-md-12">
                            <span class="col-md-3">
                                <label for="references">Suositukset</label>
                            </span>
                            <span class="col-md-9">
                                <input type="checkbox" id="references">
                            </span>
                        </div>
                        <div class="col-md-12">
                            <span class="col-md-3">
                                <label for="annualBudget">Vuosibudjetti</label>
                            </span>
                            <span class="col-md-9">
                                <input type="checkbox" id="annualBudget">
                            </span>
                        </div>
                        <div class="col-md-12">
                            <span class="col-md-3">
                                <label for="rules">Säännöt</label>
                            </span>
                            <span class="col-md-9">
                                <input type="checkbox" id="rules">
                            </span>
                        </div>
                        <div class="col-md-12">
                            <span class="col-md-3">
                                <label for="regCertificate">
                                    Rekisteröintitodistus
                                </label>
                            </span>
                            <span class="col-md-9">
                                <input type="checkbox" id="regCertificate">
                            </span>
                        </div>
                        <div class="col-md-12">
                            <span class="col-md-3">
                                <label for="annualReport">Vuosikertomus</label>
                            </span>
                            <span class="col-md-9">
                                <input type="checkbox" id="annualReport">
                            </span>
                        </div>
                        <div class="col-md-12">
                            <span class="col-md-3">
                                <label for="auditReports">
                                    Tilintarkastukset
                                </label>
                            </span>
                            <span class="col-md-9">
                                <input type="checkbox" id="auditReports">
                            </span>
                        </div>
                        <div class="col-md-12">
                            <button type="submit" class="btn btn-default"
                                    ng-disabled="true">
                                Tallenna
                            </button>
                            [<em>Toiminnon toteutus on kesken.</em>]
                        </div>
                    </form>
                    &nbsp;
                </div>
            </article>
            <article id="appendices" class="proj-article"
                     ng-show="project.appendices.length > 0">
                <h4>Tallennetut liitteet</h4>
                <div ng-repeat="appendix in project.appendices"
                     class="proj-content col-md-12">
                    <div class="col-md-2 mini-header">{{appendix.number}}.
                        <!-- TODO: Figure out how to hyperlink the
                        appendices using client-side services in order to
                        enable proper access control: -->
                        <a ng-href="{{appendix.url}}&action=download"
                           target="_blank">
                            {{appendix.category !== 'Muu...' ?
                                        appendix.category : appendix.custom_category}}
                        </a>
                    </div>
                    <div class="col-md-3">
                        <em>{{appendix.original_name}}</em>
                    </div>
                    <div class="col-md-1">
                        {{appendix.date| date: 'd.M.yyyy': 'UTC'}}
                    </div>
                    <div class="col-md-6">
                        <a data-ng-click="confirmAppendixDeletion(appendix.url)"
                           class="btn-lg">
                            <span class="glyphicon glyphicon-trash"></span>
                        </a>
                    </div>
                </div>
                &nbsp;
            </article>
            <article id="addAppendix" class="proj-article">
                <h4>Liitteen lisäys</h4>
                <!-- TODO: Figure out how to make this form work through a
                client-side service in order to enable proper acces contol: -->
                <form name="appendixForm" class="form-horizonal proj-content"
                      action="/api/projects/upload"
                      method="post" enctype="multipart/form-data">
                    <input type="hidden" name="project_id" value="{{project._id}}">
                    <div class="form-group col-md-12">
                        <label for="appendixTypeSelect"
                               class="col-md-2 control-label">
                            Kategoria
                        </label>
                        <select id="appendixTypeSelect" name="appendix_category"
                                class="col-md-4"
                                ng-model="project.appendix.category" required>
                            <option value="">[Valitse yksi]</option>
                            <option>Hankehakemus</option>
                            <option>Hankebudjetti</option>
                            <option>Rekisteröintitodistus</option>
                            <option>Suositus</option>
                            <option>Järjestön vuosibudjetti</option>
                            <option>Tilinpäätös</option>
                            <option>Sopimus</option>
                            <option>Valokuva</option>
                            <option>Hankkeessa tuotettu materiaali</option>
                            <option>Muu...</option>
                        </select>
                        <input type="text" name="appendix_custom_category"
                               value="" class="col-md-6"
                               ng-show="project.appendix.category === 'Muu...'"
                               ng-model="project.appendix.customCategory">
                    </div>
                    <div class="col-md-12">
                        <label for="appendixFileInput" class="col-md-2">
                            Tiedosto
                        </label>
                        <input type="file" id="appendixFileInput"
                               name="appendix_file" class="col-md-10"
                               accept="application/msword,application/pdf,application/rtf,application/vnd.oasis.opendocument.text,text/plain,text/csv,image/*"
                               ng-model="project.appendix.file">
                    </div>
                    <div class="form-group col-md-12">
                        <button type="submit" id="btn-add-appendix"
                                value="Submit" class="btn btn-default"
                                ng-disabled="appendixForm.$invalid || (project.appendix.category === 'Muu...' && project.appendix.custom_category === '')">
                            Tallenna
                        </button>
                    </div>
                </form>
                &nbsp;
            </article>
        </div>
    </div>
</article>
